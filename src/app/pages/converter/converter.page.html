<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Měnová kalkulačka</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="toggleFavorite()">
        <ion-icon slot="icon-only" [name]="isFavorite ? 'star' : 'star-outline'" [color]="isFavorite ? 'warning' : ''"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="converter-container">
    <ion-badge *ngIf="isOffline" color="warning" class="offline-badge">
      Offline režim
    </ion-badge>

    <div class="input-section">
      <ion-card>
        <ion-card-content>
          <ion-item lines="none">
            <ion-label position="stacked">Částka</ion-label>
            <ion-input
              type="number"
              [(ngModel)]="amount"
              (ionChange)="onAmountChange()"
              placeholder="Zadejte částku"
            ></ion-input>
          </ion-item>
        </ion-card-content>
      </ion-card>
    </div>

    <div class="currency-section">
      <ion-card>
        <ion-card-content>
          <ion-item lines="none">
            <ion-label position="stacked">Z</ion-label>
            <ion-select
              [(ngModel)]="fromCurrency"
              (ionChange)="onCurrencyChange()"
              interface="popover"
            >
              <ion-select-option *ngFor="let currency of currencies" [value]="currency.code">
                {{ currency.flag }} {{ currency.code }} - {{ currency.name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
        </ion-card-content>
      </ion-card>
    </div>

    <div class="swap-section">
      <ion-button (click)="swapCurrencies()" fill="clear" size="large">
        <ion-icon name="swap-vertical" slot="icon-only"></ion-icon>
      </ion-button>
    </div>

    <div class="currency-section">
      <ion-card>
        <ion-card-content>
          <ion-item lines="none">
            <ion-label position="stacked">Na</ion-label>
            <ion-select
              [(ngModel)]="toCurrency"
              (ionChange)="onCurrencyChange()"
              interface="popover"
            >
              <ion-select-option *ngFor="let currency of currencies" [value]="currency.code">
                {{ currency.flag }} {{ currency.code }} - {{ currency.name }}
              </ion-select-option>
            </ion-select>
          </ion-item>
        </ion-card-content>
      </ion-card>
    </div>

    <div class="result-section">
      <ion-card>
        <ion-card-content>
          <div class="result-content">
            <ion-label class="result-label">Výsledek</ion-label>
            <div class="result-value" *ngIf="!isLoading">
              <span class="currency-symbol">{{ getCurrencyInfo(toCurrency)?.symbol }}</span>
              {{ result | number:'1.2-2' }}
            </div>
            <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          </div>
        </ion-card-content>
      </ion-card>
    </div>

    <div class="rate-section" *ngIf="currentRate > 0">
      <ion-note>
        1 {{ fromCurrency }} = {{ currentRate | number:'1.4-4' }} {{ toCurrency }}
      </ion-note>
    </div>
  </div>
</ion-content>
